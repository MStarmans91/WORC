

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>User Manual &mdash; WORC 3.4.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="Quick start guide" href="quick_start.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> WORC
          

          
            
            <img src="../_static/WORC_Logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.4.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick start guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User Manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interacting-with-worc">Interacting with WORC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-worc-object">The WORC Object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#input-file-definitions">Input file definitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#attributes-sources">Attributes: Sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#images-and-segmentations">Images and segmentations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#labels">Labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="#semantics">Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#masks">Masks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metadata">Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastix-para">Elastix_Para</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#construction-and-execution-commands">Construction and execution commands</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#evaluation-of-your-network">Evaluation of your network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-data">Example data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Radiomics Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="additionalfunctionality.html">Additional functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="developerdocumentation.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_description.html">Resource File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../autogen/WORC.html">WORC Package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WORC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>User Manual</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/static/user_manual.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="user-manual">
<h1>User Manual<a class="headerlink" href="#user-manual" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we will discuss the parts of WORC in more detail, mostly focussed on the inputs,
outputs, and the various workflow possible. We will give a more complete overview of the system
and describe the more advanced features.</p>
<div class="section" id="interacting-with-worc">
<span id="tools"></span><h2>Interacting with WORC<a class="headerlink" href="#interacting-with-worc" title="Permalink to this headline">¶</a></h2>
<p>The WORC toolbox is build around of one main object, the WORC object. This object provides all functionality
of the toolbox. However, to make certain functionalities easier to use and limit the complexity,
we have constructed two facades. The <code class="docutils literal notranslate"><span class="pre">SimpleWORC</span></code> facade is the simplest to interact with and provides
all functionality required for conducting basic experiments. The <code class="docutils literal notranslate"><span class="pre">BasicWORC</span></code> object is based on the <code class="docutils literal notranslate"><span class="pre">SimpleWORC</span></code>
object and provides several more advances functions. The specific functionalities of these two facades and the
<code class="docutils literal notranslate"><span class="pre">WORC</span></code> object itself can be found in this section.</p>
<p>For documentation on <code class="docutils literal notranslate"><span class="pre">SimpleWORC</span></code> and <code class="docutils literal notranslate"><span class="pre">BasicWORC</span></code>, please look at the documentation
within those modules: <a class="reference internal" href="../autogen/WORC.facade.html#module-WORC.facade.simpleworc" title="WORC.facade.simpleworc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">WORC.facade.simpleworc</span></code></a> and <a class="reference internal" href="../autogen/WORC.facade.html#module-WORC.facade.basicworc" title="WORC.facade.basicworc"><code class="xref py py-mod docutils literal notranslate"><span class="pre">WORC.facade.basicworc</span></code></a>. Many of the functions are actually wrappers to interact with the WORC
object, and therefore use the functionality described below. For basic usage, only using
<code class="docutils literal notranslate"><span class="pre">SimpleWORC</span></code>, it’s respective documentation and the
<a class="reference external" href="https://github.com/MStarmans91/WORCTutorial/">WORCTutorial Github</a> should be sufficient.</p>
<p>Additionally, we advice you to take a look at the <a class="reference internal" href="configuration.html#config-chapter"><span class="std std-ref">configuration chapter</span></a>
for all the settings that can be adjusted in <code class="docutils literal notranslate"><span class="pre">WORC</span></code>.</p>
<div class="section" id="the-worc-object">
<h3>The WORC Object<a class="headerlink" href="#the-worc-object" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">WORC</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">WORC</span><span class="o">.</span><span class="n">WORC</span><span class="p">(</span><span class="s1">&#39;somename&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It’s attributes are split in a couple of categories. We will not discuss
the WORC.defaultconfig() function here, which generates the default
configuration, as it is listed in a separate page, see the <a class="reference internal" href="configuration.html#config-chapter"><span class="std std-ref">Config chapter</span></a>.
More detailed documentation of the various functions can be found in the docstrings of <a class="reference internal" href="../autogen/WORC.html#module-WORC.WORC" title="WORC.WORC"><code class="xref py py-mod docutils literal notranslate"><span class="pre">WORC.WORC</span></code></a>:
we will mostly focus on the attributes, inputs, outputs and workflows here.</p>
</div>
</div>
<div class="section" id="input-file-definitions">
<h2>Input file definitions<a class="headerlink" href="#input-file-definitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="attributes-sources">
<h3>Attributes: Sources<a class="headerlink" href="#attributes-sources" title="Permalink to this headline">¶</a></h3>
<p>There are numerous WORC attributes which serve as source nodes for the
FASTR network. These are:</p>
<ul class="simple">
<li><p>images_train and images_test</p></li>
<li><p>segmentations_train and segmentations_test</p></li>
<li><p>semantics_train and semantics_test</p></li>
<li><p>labels_train and labels_test</p></li>
<li><p>masks_train and masks_test</p></li>
<li><p>features_train and features_test</p></li>
<li><p>metadata_train and metadata_test</p></li>
<li><p>Elastix_Para</p></li>
<li><p>fastrconfigs</p></li>
</ul>
<p>When using a single dataset for both training and evaluation, you should
supply all sources in train objects. By default, performance on a single
dataset will be evaluated using cross-validation. Optionally, you can supply
a separate training and test set.</p>
<p>Each source should be given as a dictionary of strings corresponding to
the source filenames. Each element should correspond to a single object for the classification,
e.g. a patient. The keys are used to match the features to the
label and semantics sources, so make sure these correspond to the label
file.</p>
<p>You can off course have multiple images or ROIs per object, e.g. a liver
ROI and a tumor ROI. This can be easily done by appending to the
sources. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">images1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/image_MR.nii.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;patient2&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient2/image_MR.nii.gz&#39;</span><span class="p">}</span>
<span class="n">segmentations1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/seg_tumor_MR.nii.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;patient2&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient2/seg_tumor_MR.nii.gz&#39;</span><span class="p">}</span>
<span class="n">segmentations2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/seg_liver_MR.nii.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;patient2&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient2/seg_liver_MR.nii.gz&#39;</span><span class="p">}</span>

<span class="n">network</span><span class="o">.</span><span class="n">images_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">images1</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">images_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">images1</span><span class="p">)</span>

<span class="n">network</span><span class="o">.</span><span class="n">segmentations_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segmentations1</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">segmentations_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segmentations2</span><span class="p">)</span>
</pre></div>
</div>
<p>When using multiple sequences per patients (e.g. T1 and T2), the same
appending procedure can be used.</p>
<p>If you want to use multiple ROIs independently per patient, e.g. multiple tumors, you can do so
by simply adding them to the dictionary. To make sure the data is still split per patient in the
cross-validation, please add a sample number after an underscore to the key, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">images1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1_0&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/image_MR.nii.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;patient1_1&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/image_MR.nii.gz&#39;</span><span class="p">}</span>
<span class="n">segmentations1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1_0&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/seg_tumor1_MR.nii.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;patient1_1&#39;</span><span class="p">:</span> <span class="s1">&#39;/data/Patient1/seg_tumor2_MR.nii.gz&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>If your label file (see below) contains the label ‘’patient1’‘, both samples will get this label
in the classification.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You have to make sure the images and segmentation sources match in size.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You have to supply a configuration file for each image or feature source you append.
Thus, in the first example above, you need to append two configurations!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you use
multiple image sequences, you can supply a ROI for each sequence by
appending to to segmentations object. Alternatively, when you do not
supply a segmentation for a specific sequence, WORC will use Elastix to
align this sequence to another through image registration. It will then
warp the segmentation from this sequence to the sequence for which you
did not supply a segmentation. <strong>WORC will always align these sequences with no segmentations to the first sequence, i.e. the first object in the images_train list.</strong>
Hence make sure you supply the sequence for which you have a ROI as the first object.</p>
</div>
<div class="section" id="images-and-segmentations">
<h4>Images and segmentations<a class="headerlink" href="#images-and-segmentations" title="Permalink to this headline">¶</a></h4>
<p>The minimal input for a Radiomics pipeline consists of either images
plus segmentations, or features, plus a label file (and a configuration,
but you can just use the default one).</p>
<p>If you supply images and segmentations, features will be computed within the segmentations
on the images. They are read out using SimpleITK, which supports various
image formats such as DICOM, NIFTI, TIFF, NRRD and MHD.</p>
</div>
<div class="section" id="labels">
<span id="um-labels"></span><h4>Labels<a class="headerlink" href="#labels" title="Permalink to this headline">¶</a></h4>
<p>The labels are predicted in the classification: should be a .txt or .csv file.
The first column should head <code class="docutils literal notranslate"><span class="pre">Patient</span></code> and contain the patient ID. The next columns
can contain labels you want to predict, e.g. tumor type, risk, genetics. For example:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 38%" />
<col style="width: 31%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Patient</p></th>
<th class="head"><p>Label1</p></th>
<th class="head"><p>Label2</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>patient1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>patient2</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>patient3</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
</tr>
</tbody>
</table>
<p>These labels are matched to the correct image/features by the sample names of the image/features. So in this
case, your sources should look as following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">images_train</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1&#39;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;patient2&#39;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
<span class="n">segmentations_train</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;patient1&#39;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="s1">&#39;patient2&#39;</span><span class="p">:</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="semantics">
<h4>Semantics<a class="headerlink" href="#semantics" title="Permalink to this headline">¶</a></h4>
<p>Semantic features are non-computational features and are extracted using PREDICT. Examples include
using the age and sex of the patients in the classification. You can
supply these as a .csv listing your features per patient, similar to the <a class="reference internal" href="#um-labels"><span class="std std-ref">label file</span></a></p>
</div>
<div class="section" id="masks">
<h4>Masks<a class="headerlink" href="#masks" title="Permalink to this headline">¶</a></h4>
<p>WORC contains a segmentation preprocessing tool, called segmentix.
The idea is that you can manipulate
your segmentation, e.g. using dilation, then use a mask to make sure it
is still valid. See the <a class="reference internal" href="configuration.html#config-chapter"><span class="std std-ref">config chapter</span></a> for all segmentix options.</p>
</div>
<div class="section" id="features">
<h4>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h4>
<p>If you already computed your features, e.g. from a previous run, you can
directly supply the features instead of the images and segmentations and
skip the feature computation step. These should be stored in .hdf5 files
matching the WORC format.</p>
</div>
<div class="section" id="metadata">
<h4>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">¶</a></h4>
<p>This source can be used if you want to use tags from the DICOM header as
features, e.g. patient age and sex. In this case, this source should
contain a single DICOM per patient from which the tags that are read.
Check the PREDICT.imagefeatures.patient_feature module for the currently
implemented tags.</p>
</div>
<div class="section" id="elastix-para">
<h4>Elastix_Para<a class="headerlink" href="#elastix-para" title="Permalink to this headline">¶</a></h4>
<p>If you have multiple images for each patient, e.g. T1 and T2, but only a
single segmentation, you can use image registration to align and
transform the segmentation to the other modality. This is done in WORC
using Elastix <a class="reference external" href="http://elastix.isi.uu.nl/">http://elastix.isi.uu.nl/</a>. In this source, you can supply
a parameter file for Elastix to be used in the registration in .txt.
format. Alternatively, you can use SimpleElastix to generate a parameter
map and pass this object to <code class="docutils literal notranslate"><span class="pre">WORC</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">WORC</span></code> assumes your segmentation is made on the first
<code class="docutils literal notranslate"><span class="pre">WORC.images_train</span></code> (or test) source you supply. The segmentation
will be alligned to all other image sources.</p>
</div>
</div>
</div>
<div class="section" id="construction-and-execution-commands">
<h3>Construction and execution commands<a class="headerlink" href="#construction-and-execution-commands" title="Permalink to this headline">¶</a></h3>
<p>After supplying your sources as described above, you need to build the FASTR network. This
can be done through the <code class="docutils literal notranslate"><span class="pre">WORC.build()</span></code> command. Depending on your sources,
several nodes will be added and linked. This creates the <code class="docutils literal notranslate"><span class="pre">WORC.network</span></code>
object, which is a <code class="docutils literal notranslate"><span class="pre">fastr.network</span></code> object. You can edit this network
freely, e.g. add another source or node. You can print the network with
the <code class="docutils literal notranslate"><span class="pre">WORC.network.draw_network</span></code> command.</p>
<p>Next, we have to tell the network which sources should be used in the
source nodes. This can be done through the <code class="docutils literal notranslate"><span class="pre">WORC.set()</span></code> function. This will
put your supplied sources into the source nodes and also creates the
needed sink nodes. You can check these by looking at the created
<code class="docutils literal notranslate"><span class="pre">WORC.source_data</span></code> and <code class="docutils literal notranslate"><span class="pre">WORC.sink_data</span></code> objects.</p>
<p>Finally, after completing above steps, you can execute the network
through the <code class="docutils literal notranslate"><span class="pre">WORC.execute()</span></code> command.</p>
<p>Thus a typical experiment in <code class="docutils literal notranslate"><span class="pre">WORC</span></code> would follow the following structure,
assuming you have created the relevant objects as listed above:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">WORC</span>

<span class="c1"># Create object</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">WORC</span><span class="o">.</span><span class="n">WORC</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>

<span class="c1"># Append sources</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">images_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">images_train</span><span class="p">)</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">segmentations_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segmentations_train</span><span class="p">)</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">labels_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels_train</span><span class="p">)</span>

<span class="c1"># Create a configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">defaultconfig</span><span class="p">()</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">configs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Build, set, and execute</span>
<span class="n">network</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">network</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">network</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="evaluation-of-your-network">
<h2>Evaluation of your network<a class="headerlink" href="#evaluation-of-your-network" title="Permalink to this headline">¶</a></h2>
<p>In WORC, there are two options for testing your fitted models:</p>
<ol class="arabic simple">
<li><p>Single dataset: cross-validation (currently only random-split)</p></li>
<li><p>Separate train and test dataset: bootstrapping on test dataset</p></li>
</ol>
<p>Within these evaluation settings, the following performance evaluation methods are used:</p>
<ol class="arabic">
<li><p>Confidence intervals on several metrics:</p>
<blockquote>
<div><p>For classification:</p>
<ol class="loweralpha simple">
<li><p>Area under the curve (AUC) of the receiver operating characteristic (ROC) curve. In a multiclass setting, weuse the multiclass AUC from the <a class="reference external" href="https://tadpole.grand-challenge.org/">TADPOLE Challenge</a>.</p></li>
<li><p>Accuracy.</p></li>
<li><p>Balanced Classification Accuracy (BCA) as defined by the <a class="reference external" href="https://tadpole.grand-challenge.org/">TADPOLE Challenge</a>.</p></li>
<li><p>F1-score</p></li>
<li><p>Sensitivity, aka recall or true positive rate</p></li>
<li><p>Specificity, aka true negative rate</p></li>
<li><p>Negative predictive value (NPV)</p></li>
<li><p>Precision, aka Positive predictive value (PPV)</p></li>
</ol>
<p>For regression:</p>
<ol class="loweralpha simple">
<li><p>R2-score</p></li>
<li><p>Mean Squared Error (MSE)</p></li>
<li><p>Intraclass Correlation Coefficient (ICC)</p></li>
<li><p>Pearson correlation coefficient and p-value</p></li>
<li><p>Spearman correlation coefficient and p-value</p></li>
</ol>
<p>For survival, in addition to the regression scores:
a. Concordance index
b. Cox regression coefficient and p-value</p>
<p>In cross-validation, by default, 95% confidence intervals for the mean performance measures are constructed using
the corrected resampled t-test base on all cross-validation iterations, thereby taking into account that the samples
in the cross-validation splits are not statistically independent. See als
<cite>Nadeau C, Bengio Y. Inference for the generalization error. In Advances in Neural Information Processing Systems, 2000; 307–313.</cite></p>
<p>In bootstrapping, 95% confidence intervals are created using the ‘’standard’’ method according to a normal distribution: see Table 6, method 1 in  <cite>Efron B., Tibshirani R. Bootstrap Methods for Standard Errors,
Confidence Intervals, and Other Measures of Statistical Accuracy, Statistical Science Vol.1, No,1, 54-77, 1986</cite>.</p>
</div></blockquote>
</li>
<li><p>ROC curve with 95% confidence intervals using the fixed-width bands method, see <cite>Macskassy S. A., Provost F., Rosset S. ROC Confidence Bands: An Empirical Evaluation. In: Proceedings of the 22nd international conference on Machine learning. 2005.</cite></p></li>
<li><p>Univariate statistical testing of the features using:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>A student t-test</p></li>
<li><p>A Welch test</p></li>
<li><p>A Wilcoxon test</p></li>
<li><p>A Mann-Whitney U test</p></li>
</ol>
<p>The uncorrected p-values for all these tests are reported in a single excel sheet. Pick the right test and significance
level based on your assumptions. Normally, we make use of the Mann-Whitney U test, as our features do not have to be normally
distributed, it’s nonparametric, and assumes independent samples.</p>
</div></blockquote>
</li>
<li><p>Ranking patients from typical to atypical as determined by the model, based on either:</p>
<blockquote>
<div><p>a. The percentage of times a patient was classified correctly when occuring in the test set. Patients always correctly classified
can be seen as typical examples; patients always classified incorrectly as atypical.
b. The mean posterior of the patient when occuring in the test set.</p>
<p>These measures can only be used in classification. Besides an Excel with the rankings, snapshots of the middle slice
of the image + segmentation are saved with the ground truth label and the percentage/posterior in the filename. In
this way, one can scroll through the patients from typical to atypical to distinguish a pattern.</p>
</div></blockquote>
</li>
<li><p>A barchart of how often certain features groups were selected in the optimal methods. Only useful when using
groupwise feature selection.</p>
<blockquote>
<div><p>By default, only the first evaluation method, e.g. metric computation, is used. The other methods can simply be added
to WORC by using the <code class="docutils literal notranslate"><span class="pre">add_evaluation()</span></code> function, either directly in WORC or through the facade:</p>
</div></blockquote>
</li>
<li><p>Decomposition of your feature space.</p>
<blockquote>
<div><p>The following decompositions are performed:</p>
<ol class="loweralpha simple">
<li><p>Principle Component Analysis (PCA)</p></li>
<li><p>Sparse PCA</p></li>
<li><p>Kernel PCA: linear kernel</p></li>
<li><p>Kernel PCA: polynomial kernel</p></li>
<li><p>Kernel PCA: radial basis function kernel</p></li>
<li><p>t-SNE</p></li>
</ol>
<p>A decomposition can help getting insight into how your dataset can be separated. for example, if the
regular PCA shows good separation of your classes, your classes can be split using linear combinations
of your features.</p>
</div></blockquote>
</li>
</ol>
<p>To add the evaluation workflow, simply use the <code class="docutils literal notranslate"><span class="pre">add_evaluation</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">WORC</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">WORC</span><span class="o">.</span><span class="n">WORC</span><span class="p">(</span><span class="s1">&#39;somename&#39;</span><span class="p">)</span>
<span class="n">label_type</span> <span class="o">=</span> <span class="s1">&#39;name_of_label_predicted_for_evaluation&#39;</span>
<span class="o">...</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span><span class="n">label_type</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">WORC</span>
<span class="kn">from</span> <span class="nn">WORC</span> <span class="kn">import</span> <span class="n">SimpleWORC</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="n">SimpleWORC</span><span class="p">(</span><span class="s1">&#39;somename&#39;</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>As WORC is based on fastr, debugging is similar to debugging a fastr pipeline: see therefore also
<a class="reference external" href="https://fastr.readthedocs.io/en/stable/static/user_manual.html#debugging/">the fastr debugging guidelines</a>.</p>
<p>If you run into any issue, please create an issue on the <a class="reference external" href="https://github.com/MStarmans91/WORC/issues/">WORC Github</a>.</p>
</div>
<div class="section" id="example-data">
<h2>Example data<a class="headerlink" href="#example-data" title="Permalink to this headline">¶</a></h2>
<p>For many files used in typical WORC experiments, we provide example data. Some
of these can be found in the exampledata folder within the WORC package:
<a class="reference external" href="https://github.com/MStarmans91/WORC/tree/master/WORC/exampledata">https://github.com/MStarmans91/WORC/tree/master/WORC/exampledata</a>. To
save memory, for several types the example data is not included, but a script
is provided to create the example data. This script (<code class="docutils literal notranslate"><span class="pre">create_example_data</span></code>) can
be found in the exampledata folder as well.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="configuration.html" class="btn btn-neutral float-right" title="Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quick_start.html" class="btn btn-neutral float-left" title="Quick start guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 -- 2020, Biomedical Imaging Group Rotterdam, Departments of Medical Informatics and Radiology, Erasmus MC, Rotterdam, The Netherlands

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>